<Cmdname sid="application_topology" className="uitext" />는 트랜잭션의 흐름과 관련된 데이터베이스 및 외부 서비스 호출을 시각적으로 보여줍니다. 사용자 요청부터 데이터베이스 호출, 외부 서비스 연동까지 전체 경로를 한눈에 파악할 수 있어, 성능 병목 지점을 쉽게 확인할 수 있습니다.

- 사용자 요청 → DB/외부 서비스까지의 경로 시각화
- URL 패턴을 기준으로 한 필터링 조회
- 트랜잭션 성능 상태(느림/에러 등) 확인
- 병목 지점 식별 및 상세 정보 확인

## 토폴로지 조회

시간 범위와 애플리케이션을 선택한 후, 아래 옵션으로 조회 범위를 설정합니다. 조회할 때 마다 새로운 탭에 표시됩니다. 탭에 마우스를 올리면 조회 조건이 툴립으로 나타나며, 툴팁 내 새 창 버튼을 클릭하면 해당 조건으로 조회된 토폴로지가 팝아웃으로 열립니다.

### 트랜잭션 URL 검색

특정 URL 패턴의 트랜잭션을 호출한 도메인만 표시합니다. 와일드카드(`*`)를 사용하여 패턴을 설정할 수 있습니다.

**실제 사용 예시**

- `/api/*`: /api/로 시작하는 모든 URL

- `*/users/*`: users가 포함된 모든 URL

- `/api/v1/users`: 정확히 일치하는 URL

:::warning 

**슬래시(`/`)와 와일드카드(`*`) 조합에 주의하세요.**

- `/api/*`: `/api`는 매칭되지 않음, `/api/` 뒤에 경로가 있어야 매칭(예: 🔵 `/api/users`, ❌ `/api`)

- `/api*`: `/api` 자체도 매칭됨(예: 🔵 `/api`, `/api/users`, `/apitest`)

:::

#### 패턴 제한사항

- **필수 문자열**: 패턴에 와일드카드(`*`) 외에 최소 1개 이상의 문자가 포함되어야 합니다. 와일드카드만으로 패턴을 설정할 수 없습니다.
    - ❌ 불가: `***`, `**`
    - 🔵 가능: `a*`, `*a`, `*a*`, `/api*`

- **빈 문자열**: 빈 문자열이나 null은 매칭되지 않습니다.

- **연속된 와일드카드**: `**`는 `*`와 동일하게 처리됩니다.

- **복잡한 패턴**: 3개 이상의 `*` 가 포함된 패턴은 완전히 지원되지 않습니다.

- **정규식 미지원**: 문자 클래스(`[a-z]`), 수량자(`+`, `?`), 그룹화(`()`) 등은 지원하지 않습니다.

- **대소문자 구분**: 모든 패턴 매칭은 대소문자를 구분합니다.

- **이스케이프 불가**: `*` 문자 자체를 매칭할 방법은 없습니다.

### 조회 제한 건수

조회할 최대 트랜잭션 트레이스(프로파일) 건수입니다. 건수가 늘어날수록 더 많은 데이터를 볼 수 있지만 조회 시간이 길어집니다. 

- 기본값: 10,000건

- 최대값: 1,000,000건

:::caution

Limit을 늘려도 필터 조건에 맞는 트랜잭션 전체를 조회하지 못할 수 있습니다. 설정된 건수에 도달하면 화면에 경고 메시지가 표시됩니다.

:::

### 조회 제한 시간

조회 제한 시간 도달 시 해당 시점까지의 데이터만 표시되며 화면에 경고 메시지가 표시됩니다.

- 범위: 30초 ~ 5분

- 기본값: 1분

## 화면 구성 및 시각화

화면에는 원형의 **노드**와 노드를 연결하는 **연결선**으로 트랜잭션 흐름을 시각화합니다.

<ImgLang img='app-topology.png' desc='애플리케ㅐ이션 토폴로지 new' />

### 노드 구조

노드는 트랜잭션 실행 흐름에 따라 위에서 아래로 배치되며, 상위 노드가 하위 노드를 호출합니다.

#### 노드 타입

노드는 위에서 아래로 User → TX → DB/HTTPC 순서로 배치됩니다.

| 노드 타입 | 설명 |
| --- | --- |
| **User** | 트랜잭션을 호출한 사용자 수 |
| **TX (Transaction)** | 애플리케이션 트랜잭션(HTTP 도메인/URL) |
| **DB (Database)** | 데이터베이스 쿼리 및 연결 |
| **HTTPC (HTTP Call)** | 외부 HTTP 호출 |

#### 노드 시각 요소

- **에러 게이지**: 노드 외곽선에 원형 게이지로 에러율 표시 (에러 발생 시)
- **성능 태그**: 평균 경과 시간에 따라 노드 상단에 “<span class='slow'>Slow</span>”(주황색) 또는 “<span class='vslow'>Very Slow</span>”(빨간색) 배지 표시
- **호버 효과**: 마우스 올리면 회색 테두리 + 연결 경로 강조
- **선택 효과**: 클릭 시 파란색 테두리 + 연결 경로 강조

### 연결선

연결선 평균 경과 시간에 따라 색상이 변경됩니다.

- **회색**: 일반 상태
- **<span class='slow'>주황색</span>**: 느림(Slow 임계값 이상, 기본 3초)
- **<span class='vslow'>빨간색</span>**: 매우 느림(Very Slow 임계값 이상, 기본 8초)

### 결과 요약

화면 상단에 조회 결과의 핵심 지표가 표시됩니다.

- **총 건수**: 조회된 전체 트랜잭션 수
- **에러 수**: 에러가 발생한 트랜잭션 수
- **평균 응답시간**: 전체 트랜잭션의 평균 응답시간

## 화면 조작 방법

| 구분                                     | 동작                    | 설명                                                                 |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------- |
| **스크롤 및 줌**                         | **마우스 휠**           | 세로 스크롤(위/아래)                                                 |
| ^                                        | **Shift** + **마우스 휠** | 가로 스크롤(좌/우)                                                   |
| ^                                        | **Ctrl** + **마우스 휠**  | 줌 확대/축소                                                         |
| **드래그**                               | **캔버스 드래그**       | 빈 공간 드래그로 전체 토폴로지 이동                                  |
| ^                                        | **노드 드래그**         | 개별 노드 드래그로 위치 조정                                         |
| **노드 인터랙션**                        | **노드 호버**           | 마우스를 올리면 해당 노드와 연결된 모든 경로 강조                    |
| ^                                        | **노드 클릭**           | 선택한 노드 파란색 테두리로 강조, 연결 경로 표시 및 상세 정보창 열림 |
| ^                                        | **재클릭**              | 선택 해제                                                            |
| **줌 컨트롤** | **확대(+) / 축소(-)**   | 줌 확대 및 축소(범위: 0.1x ~ 2.0x)                                                     |
| ^                                        | **화면 맞춤**           | 전체 토폴로지를 화면에 자동 맞춤                                     |
| ^                                        | **리셋**                | 줌 초기화                                                            |
| ^                                        | **줌 슬라이더**         | 드래그로 세밀한 줌 조정                                              |
| **이미지 다운로드**                      | **PNG 다운로드**        | 현재 차트 화면을 PNG로 저장                                          |
| **미니맵**                               | **위치 확인**           | 우측 하단에 현재 보기 영역을 파란색 사각형으로 표시                  |
| ^                                        | **지도 아이콘**         | 표시/숨김 전환                                                       |
| **도메인 검색**                          | **검색창 입력**         | 키워드 입력 시 일치 노드 강조, 일치하지 않는 노드는 투명 처리        |

## 화면 표시 설정 옵션

토폴로지 표시 방식을 세밀하게 조정할 수 있습니다.

### 노드 라벨

각 노드에 표시할 정보를 선택합니다.

- **호출 건수**: 노드 타입별로 형식화 (예: “1,234 Calls”, “567 SQL”, “89 HTTP Calls”)
- **에러 건수**:
    - **표시 모드**: 백분율(%) 또는 건수
    - **임계값**: 설정값 초과 시만 에러 색상 표시 (빨간색 텍스트)
    - 예: 백분율 5% 설정 시, 에러율 5% 초과 노드만 에러 색상 표시
- **평균 경과 시간**: 밀리초 단위
- **이름**: 도메인명, DB URL 등
- **타입**: TX, DB, HTTPC, User

### 연결선 라벨

연결선에 배지 형태로 정보를 표시합니다.

- **표시 모드**
    - **항상 표시**: 모든 연결선 라벨 항상 표시
    - **선택 시 표시**: 노드 호버/클릭 시 관련 경로의 연결선 라벨만 표시 (기본값)
- **표시 정보**:
    - **호출 건수**: 타겟 노드 타입에 따라 형식화 (예: “1,234 Calls”, “567 SQL”)
    - **에러 건수/에러율**:
        - 임계값 초과 시 <span class='vslow'>빨간색 배경</span>으로 강조
        - 하단에 에러율 게이지 바 표시
    - **평균 경과 시간**:
        - 일반: 흰색 배경
        - 느림: <span class='slow'>주황색 배경</span>
        - 매우 느림: <span class='vslow'>빨간색 배경</span>

### 기타 설정

- **연결선 애니메이션**: Slow/Very Slow 상태 연결선 애니메이션 표시 여부 제어
- **사용자 노드 표시/숨김**: User 노드 표시 여부 제어
- **고립된 노드 숨기기**: 연결되지 않은 독립 노드 제거
- **동일 노드 병합**: 도메인이 동일한 노드 병합, 성능 지표 합산. 클릭 시 소스 도메인별 분석 테이블 제공
- **HTTPC/TX 노드 병합**: HTTP 클라이언트 호출과 대응 트랜잭션 노드 병합

### 경과 시간 임계값

노드 성능 태그와 연결선 색상을 결정하는 기준값입니다. <span class='slow'>Slow</span>는 <span class='vslow'>Very Slow</span>보다 작아야 합니다.

- **<span class='slow'>Slow</span>(느림)**: 기본값 3초, 주황색
- **<span class='vslow'>Very Slow</span>(매우 느림)**: 기본값 8초, 빨간색

## 노드 상세 정보

### 툴팁

노드에 마우스를 올리면 정보가 툴팁으로 표시됩니다.

- 노드 타입 및 이름
- 호출 건수
- 에러 건수 및 에러율 (에러 시 빨간색)
- 평균 경과 시간
- 병합된 노드: 상위 10개 소스 도메인의 성능 테이블(에러율 > 에러 건수 > 평균 경과 시간 > 건수 > 이름 순 정렬)

### 상세 드로어

노드 클릭 시 우측에 상세 정보가 표시됩니다.

- **성능 지표**
    - 호출 수
    - 에러 수 / 에러율
    - 평균 경과 시간
    - 노드 타입별 추가 정보 (도메인, DB 서버, 드라이버 등)
- **병합된 노드**
    - 소스 도메인별 성능 분석 테이블
- **Caller 트랜잭션 목록** (최대 1,000건)
    - 상태 필터 (전체/액티브 스택/멀티 트랜잭션/에러)
    - 텍스트 검색
    - 컬럼별 정렬
    - CSV 다운로드
    - 행 클릭 시 트레이스 상세 팝업
