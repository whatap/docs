홈 화면 &gt; 프로젝트 선택 &gt; <Cmdname sid="dashboard" className="uitext" /> &gt; **인스턴스 맵**

**인스턴스 맵**은 데이터베이스 서버를 모니터링하고 있는 인스턴스들의 상태를 시각화하여 어렵게 느껴질 수 있는 데이터베이스 모니터링을 쉽게 접근할 수 있도록 돕습니다.

데이터베이스 서버의 핵심 지표에 임계치 설정을 통해 데이터베이스의 상태를 한 눈에 파악할 수 있고 수행되고 있는 액티브 세션을 실시간으로 확인할 수 있습니다. 또한 인스턴스 모니터링/멀티 인스턴스 모니터링 등의 화면으로 이동하여 장애가 발생한 데이터베이스의 분석을 빠르게 수행할 수 있도록 연계됩니다.

<ImgLang img="db-instance-map.png" desc="Instance Map" />

:::note

CPU 사용량, 메모리 사용량 등 데이터베이스 서버의 프로세스 사용량은 XOS 에이전트를 실행하여 데이터를 수집할 수 있습니다

:::

## 기본 화면

**인스턴스 맵**은 크게 **사용자 설정** 영역과 인스턴스 **맵 차트** 영역으로 구성되어 있습니다. 

<ImgLang img="db-instance-map-setting.png" desc="Instance Map Setting" />

### 사용자 설정

**인스턴스 맵** 화면 위의 사용자 설정 영역에서 **그룹화**, **임계치 설정**, **라벨**, **필터**, **프리셋**, ![설정 아이콘](/img/ico-setting.svg) **추가 설정**을 할 수 있습니다.

#### 그룹화

인스턴스를 다양한 기준으로 그룹화하거나 사용자가 원하는 기준으로 묶어서 모니터링 할 수 있습니다. 그룹화 기능은 최대 2단계까지 지원됩니다. 2단계 그룹을 클릭하면, 해당 그룹에 속한 인스턴스들의 데이터를 모아서 볼 수 있는 상세보기 화면이 나타납니다.

#### 임계치 설정

데이터베이스 모니터링의 핵심 지표에 임계치 설정을 통해 인스턴스 상태를 색상으로 표현할 수 있습니다. 지표는 하나 이상 설정 가능하며 지표별로 경고(<span class='slow'>Warning</span>)와 심각(<span class='vslow'>Critical</span>) 구간을 지정할 수 있습니다. 정상(<span class='normal'>Normal</span>) 구간은 <span class='normal'>파란색</span>으로 표시됩니다. 설정한 범위에 따라 해당 상태의 색상이 적용됩니다.

1. 화면 위의 **임계치 설정** 옵션을 클릭하세요.

1. 원하는 지표를 선택 후 Warning과 Critical 구간을 설정하세요.

1. 지표 추가를 원하는 경우 하단의 **+ 지표 추가**를 클릭하세요.

1. 원하는 지표별 임계치 설정을 마쳤으면 **저장** 버튼을 클릭하세요.

**인스턴스 상태 표시 우선 순위**

상태 표시 우선 순위는 <span class='vslow'>Critical</span> 구간이 가장 높습니다. 여러 지표 중 하나의 항목이라도 <span class='vslow'>Critical</span> 구간에 속할 경우 해당 인스턴스는 빨간색으로 표시됩니다. 다음 예시의 경우 두 인스턴스 모두 <span class='vslow'>Critical</span>로 표시됩니다.

#### 라벨

인스턴스 아이콘 내부에 텍스트 라벨을 표시합니다. 라벨의 종류는 데이터베이스 정보 및 주요 지표로 구성되어 있습니다.

#### 필터

필터를 지정하여 특정 인스턴스를 집중적으로 모니터링할 수 있습니다.

* 필터 키: 데이터베이스 및 인스턴스 정보를 필터 키로 제공합니다.

    * 수집 컬럼: 인스턴스 이름, 클러스터/리플리케이션 정보, 에이전트 버전, CPU 코어 갯수, 데이터베이스의 종류, 설치 위치, 버전, IP, Port

* 조건: 필터 조건은 `≥`, `≤`, `>`, `<` 등의 숫자형 조건과 일치, 불일치, 포함, 미포함과 같은 문자열 조건으로 설정할 수 있습니다.

#### 프리셋

사용자는 설정한 옵션을 프리셋으로 저장하고 필요 시 불러올 수 있습니다. 프리셋은 프로젝트 단위로 저장됩니다. 이를 통해 프로젝트 멤버들이 동일한 설정으로 인스턴스를 모니터링할 수 있습니다. 기본 프리셋(Default)을 제공하며 기본 프리셋의 경우 삭제할 수 없습니다.

:::tip

**기본 프리셋**

인스턴스 맵의 기본 프리셋은 active_sessions와 lock_wait_sessions 지표의 임계치가 다음과 같이 설정되어 있습니다.

* active_sessions

    * <span class='slow'>Warning</span>: 값이 20 이상

    * <span class='vslow'>Critical</span>: 값이 30 이상

* lock_wait_sessions

    * <span class='slow'>Warning</span>: 값이 1 이상

    * <span class='vslow'>Critical</span>: 값이 3 이상

:::

#### 추가 설정

인스턴스 맵 오른쪽 위의 ![설정 아이콘](/img/ico-setting.svg) 아이콘을 클릭해, 추가 설정할 수 있습니다.

* **1차 그룹 없음 표시**: 1차 그룹 설정 시 기준이 되는 그룹이 없는 ‘그룹 없음’의 표시 여부

* **그룹 하단 메트릭 영역 표시**: 하단 지표 정보 요약 표시 여부

### 인스턴스 맵 차트

인스턴스 맵 차트는 세 가지 영역으로 구성되어 있습니다.

#### 상단 영역

인스턴스의 전체 개수 또는 그룹화된 경우, 그룹화된 항목들의 총 개수와 선택한 지표의 상태별 개수를 표시합니다.

#### 인스턴스 시각화 영역

전체 인스턴스 상태와 개수를 직관적으로 확인할 수 있는 시각화된 대시보드를 제공합니다.

#### 하단 영역

주요 지표의 인스턴스 평균값을 표시합니다. ![설정 아이콘](/img/ico-setting.svg)의 **그룹 하단 메트릭 영역 표시** 옵션을 통해 켜고 끌 수 있습니다.

## 요약 보기 및 상세 분석

**인스턴스 맵**에서 조회를 원하는 인스턴스를 선택하세요. 오른쪽에 나타나는 요약 보기 화면에서 해당 인스턴스의 요약 정보를 **인스턴스 개요**, **메트릭스**, **액티브 세션**, **이벤트**, **로그 탭**에서 확인할 수 있습니다. 요약 보기 화면에서 **상세 분석** 버튼을 클릭해 상세 분석 화면을 확인할 수 있습니다.

<ImgLang img="db-instance-map-view-detailed.png" desc="Instance Map Setting view detatiled" />

### 인스턴스 개요

상세 분석 페이지의 **인스턴스 개요** 탭에서 선택한 인스턴스가 모니터링하고 있는 데이터베이스의 정보와 지표 정보, 발생한 이벤트를 확인할 수 있습니다. 또한 인스턴스 모니터링 메뉴로 이동할 수 있고, 비활성화된 인스턴스의 경우 비활성화된 시점의 인스턴스 모니터링으로 이동합니다.

* 이벤트 영역: 사용자가 설정한 경고 알림 기준에 따른 이벤트 발생 정보를 제공합니다. 각 이벤트 카드를 클릭하면, 어떤 이벤트가 발생했는지 확인할 수 있습니다.

* 지표 영역: 주요 데이터베이스 지표 및 리소스 사용 현황을 실시간으로 확인할 수 있습니다. 리소스 사용 현황은 XOS 에이전트를 설정하면 확인할 수 있습니다.

    * 데이터베이스 지표

        * Active Sessions: 쿼리를 실행중인 세션 수

        * Lock Wait Sessions: lock을 대기하는 세션 수

        * Session Logical Reads: 메모리에서 읽은 데이터 블록 수, db block gets과 consistent gets의 합

        * Execute Count: SQL 문(statement)을 실행한 총 호출 수

    * 리소스 사용 현황(Resource Map(XOS))

        * CPU Usage: CPU 사용량

        * Disk Usage: 메모리 사용량

        * Memory Usage: 사용 중인 디스크 용량과 사용 비율

        * Network I/O: 네트워크 전송량

* 데이터베이스 정보 영역(Datebase Info): 데이터베이스 정보를 확인할 수 있습니다. 인스턴스 모니터링을 클릭하면 선택한 인스턴스의 인스턴스 모니터링 화면으로 이동할 수 있습니다.

#### 인스턴스 개요 상세 보기 

상세 보기 화면의 **인스턴스 개요** 탭에서 여러 인스턴스를 선택하여 주요 지표 및 데이터베이스 정보를 테이블 형태로 모니터링할 수 있습니다. **인스턴스 개요** 탭의 오른쪽 위의 **상세 보기** 버튼을 클릭하거나 2차 그룹 설정 후 인스턴스 시각화 영역의 2차 그룹 이름을 클릭하면 상세 보기 화면으로 이동합니다.

<ImgLang img="db-instance-map-view-detailed-cases.png" desc="Instance Map Setting view detatiled page" />

* **상세 보기** 화면에서 시각화 영역의 인스턴스 아이콘을 클릭하거나 화면 왼쪽 아래의 인스턴스 목록을 클릭하면 인스턴스를 선택하거나 선택 해제할 수 있습니다. **전체 선택**을 클릭하거나 **전체 해제**를 클릭하면, 전체 인스턴스를 선택하거나 해제할 수 있습니다. 

* 여러 인스턴스를 선택한 경우, **멀티 인스턴스 모니터링 >** 버튼을 클릭하여 선택된 인스턴스들을 **멀티 인스턴스 모니터링**으로 이동해 모니터링할 수 있습니다.

### 메트릭스

**메트릭스** 탭에서 선택한 인스턴스의 지표 추이를 확인할 수 있습니다. 시간 선택자를 조작하여 실시간 혹은 과거 지표 추이를 확인할 수 있습니다.

### 액티브 세션

**액티브 세션** 탭에서 실시간 수행 중인 세션과 쿼리 내용을 조회할 수 있습니다.

:::note

테이블 목록의 글자 색상은 검정색 → <span class='slow'>주황색</span> → <span class='vslow'>빨간색</span> 순으로 세션의 수행 속도가 느린 것을 의미합니다.

:::

### 이벤트

**이벤트** 탭에서 한 시간 동안 발생한 이벤트를 확인할 수 있습니다. 발생한 이벤트 항목을 클릭하면 이벤트가 발생한 시간의 인스턴스 모니터링 화면으로 이동합니다.

### 로그

**로그** 탭에서 발생한 로그 확인 및 실시간 로그를 확인할 수 있습니다. 오른쪽의 **상세 보기** 버튼을 클릭하면 더 자세한 로그를 확인할 수 있습니다.