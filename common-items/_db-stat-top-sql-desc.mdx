홈 화면 &gt; 프로젝트 선택 &gt; <Cmdname sid="laboratory" className="uitext" /> &gt; **Top SQL**

**TOP SQL**은 기존 SQL 통계 메뉴의 기능을 확장해 긴 기간 동안 데이터를 조회하고 분석할 수 있습니다. 최대 30일~최소 1분 단위로 조회할 수 있으며, 분석 지표를 탭 형태로 제공해 한눈에 볼 수 있습니다. 또한, 추이 차트를 추가하여 특정 시간의 SQL 발생 패턴을 쉽게 파악할 수 있습니다.

## 기본 화면 안내

<ImgLang img='db-top-sql-stat.png' desc='Top SQL' />

1. **시간**에서 데이터를 조회할 시간과 날짜를 선택하세요. 

    - 녹색 버튼을 클릭해 조회 시간을 선택하거나 날짜와 시간 텍스트 영역을 클릭하면 날짜와 시간을 옵션으로 선택할 수 있습니다.
    
1. **인스턴스**에서 데이터를 조회할 대상을 선택하세요.

1. **필터** 조건을 추가하세요. **필드**에서 **필터**에 추가할 컬럼을 쉽게 검색하고 추가할 수 있습니다. 
    
1. <Cmdname sid="TTL07773" className="uitext" />에서 테이블에 표시할 건수를 설정하세요.

    - 데이터는 10~100건까지 테이블에 표시합니다.

1. ![검색 아이콘](/img/ico-btn-search.png) 버튼을 클릭하세요.

    - 조회한 내용을 CSV 형식의 파일로 다운받으려면 ![다운로드 아이콘](/img/ico-download.svg) 버튼을 클릭하세요.

    - 테이블 헤더의 각 컬럼을 클릭하면 선택한 컬럼을 기준으로 목록을 정렬할 수 있습니다.

:::note

<Cmdname sid="time" className="uitext" /> 옵션 이용 방법은 [다음 문서](usage-ui#timeselector)를 참고하세요.

:::

### 필터링 조건 설정하기

원하는 데이터를 빠르게 찾기 위해 필드 조건을 추가하거나 필터 조건을 설정할 수 있습니다.

#### 사이드 바 필드에 조건 추가하기

**필드**에서 필드명을 확인하고, 검색해 원하는 조건의 데이터를 조회할 수 있습니다. 

* 필드 검색 기능을 통해 원하는 필드를 빠르게 찾을 수 있습니다.

* 필드 유형은 ![문자 아이콘](/img/ico-string.svg) (문자 타입), ![필드 아이콘](/img/ico-field.svg) (숫자 타입) 아이콘으로 구분할 수 있습니다.

1. 필드 목록에서 원하는 항목에 마우스를 올리면, 해당 필드의 데이터 타입에 따라 조건 아이콘이 나타납니다. 

    * `String`(문자) 타입 필드 조건: `=`(포함), `!=`(미포함)

    * `Number`(숫자) 타입 필드 조건: `==`(같음), `≥`(보다 크거나 같음), `≤`(보다 작거나 같음)

2. 원하는 조건 아이콘을 클릭한 후, 값을 입력합니다. 

3. **적용** 버튼을 클릭해 필드 조건을 추가합니다.

#### 상단 옵션 바 필터에 조건 추가하기

1. <Cmdname sid="filter" className="uitext" /> 옵션에서 <LinkImage img="ico-add.svg" className="ico" /> 아이콘을 클릭하세요.

1. <Cmdname sid="TTL06740" className="uitext" /> 항목에서 원하는 필터링 기준을 선택하세요.

    * 선택한 항목의 값이 문자에 해당한다면 <Cmdname sid="includes" className="uitext" />(파란색), <Cmdname sid="excludes" className="uitext" />(빨간색) 조건을 선택할 수 있습니다.

        <InDoc pages="stat,top-sql"><ImgLang img="db-sql-filter-condition-color.png" desc="example" multi /></InDoc>

        <InDoc pages="analysis-sql"><ImgLang img="db-sql-analysis-filter-condition-color.png" desc="example" multi /></InDoc>

1. <Cmdname sid="condition" className="uitext" /> 항목에서 조건을 선택하고, 조건과 일치시킬 문자열 또는 숫자를 입력하세요.

1. <Cmdname sid="apply" className="uitext" /> 버튼을 클릭하세요.

    * 필터링 조건을 추가하려면 <Cmdname sid="bsm_button_add" className="uitext" /> 버튼을 클릭한 후, 1 ~ 4를 반복하세요. 추가한 조건은 AND(`&&`) 조건으로 적용됩니다.


#### 필터 조건 삭제하기 

* 특정 조건을 삭제하려면 필터 조건 오른쪽 ![삭제 아이콘](/img/ico-trash.svg) 버튼을 클릭하세요.

* 전체 조건을 삭제하려면 ![삭제 아이콘](/img/ico-trash.svg) <Cmdname sid="BTN06616" className="uitext" /> 버튼 클릭하세요.

* <Cmdname sid="filter" className="uitext" /> 옵션에 적용된 조건을 빠르게 삭제하려면 <LinkImage img="ico-close.svg" className="ico" /> 버튼을 클릭하세요.

:::note

<InDoc pages="stat,top-sql">

    `sqlText`에 'WhaTap'이 포함된 경우 제외하도록 기본 설정되어 있습니다.

    <ImgLang img='db-sql-filter-default.png' desc='WhaTap' />

</InDoc>

:::


#### 필터 조건 수정하기

1. <Cmdname sid="filter" className="uitext" /> 옵션에 적용된 항목을 클릭하세요. 

1. <Cmdname sid="TTL06737" className="uitext" /> 창에서 원하는 항목을 수정하고 <Cmdname sid="apply" className="uitext" /> 버튼을 클릭하세요.

### Trends 차트 확인하기 {#trends-chart}

<InDoc product='mysql,oracle,oracle-pro'><ProdImg img='db-top-sql-trends-chart.png' desc='Top SQL' /></InDoc>

**Trends** 차트의 SQL 통계 데이터 수집 주기와 데이터 조회 범위는 아래 기준에 따라 다릅니다. 

* **3시간 이하**
    * **SQL 통계 데이터 수집 주기 옵션이 1분으로 설정된 경우**: 1분 간격으로 데이터 수집
    * **SQL 통계 데이터 수집 주기 옵션이 1분으로 설정되지 않은 경우**: 5분 간격으로 데이터 수집
* **1일 이하**: 5분 간격으로 데이터 수집
* **30일 이하**: 1시간 간격으로 데이터 수집  

:::note

**SQL 통계 데이터 수집 주기 옵션 설정하기(차트 인터벌)**

1분 단위의 서머리 데이터를 표시하려면 에이전트 버전과 에이전트 설정을 확인해야 합니다.

1. 에이전트 버전 2.4.5 이상으로 업데이트하세요.

1. whatap.conf 파일에 `sqlstat_send_interval = 1` 설정을 추가하세요.

:::