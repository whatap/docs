---
id: agent-weaving
title: 오픈소스 추적
description: 자바(Java) 애플리케이션에서 사용하는 프레임워크나 오픈소스 라이브러리를 에이전트를 통해 추적하는 설정 방법을 제공합니다. Java 에이전트 설정 파일(whatap.conf)에 weaving 옵션을 추가하여 설정하며, 다양한 프레임워크 및 라이브러리 버전에 대응하는 방법을 안내합니다.
keywords: [ Java, 에이전트, 오픈소스 추적, Weaving ]
---

자바(Java) 애플리케이션에서 사용하는 프레임워크나 오픈소스 라이브러리를 에이전트를 통해 추적하는 설정 방법을 제공합니다. 이는 Java 에이전트 설정 파일(*whatap.conf*) 파일에 `weaving` 옵션을 추가하여 설정하며, 다양한 프레임워크 및 라이브러리 버전에 대응하는 방법을 안내합니다.

예를 들어, 프레임워크나 오픈소스로 spring-boot-3.x, feign-client-11, okhttp3-4.4 사용 시 다음과 같이 옵션을 설정하세요.
```ini title='whatap.conf'
weaving=spring-boot-3.0,feign-11,okhttp3-4.4
```

## 지원 오픈소스 목록

Java 에이전트를 통해 추적하고 있는 프레임워크 또는 오픈소스에 대한 설정 방법은 다음을 참조하세요.

### Apache Camel

#### CXF

| camel-cxf Version | 설정 값                | 에이전트 최소 버전 |
| ----------------- | ---------------------- | :----------------: |
| 3.15 이상         | weaving=camel-cxf-3.15 | <Link to="../release-notes/java/java-2_2_27" target="_blank">v2.2.27</Link>            |

#### Netty

| camel-netty4 Version | 설정 값                   | 에이전트 최소 버전 |
| -------------------- | ------------------------- | :----------------: |
| 2.25 이상            | weaving=camel-netty4-2.25 | <Link to="../release-notes/java/java-2_2_42" target="_blank">v2.2.42</Link>          |

#### SEDA

| camel-seda Version | 설정 값                 | 에이전트 최소 버전 |
| ------------------ | ----------------------- | :----------------: |
| 2.22 이상          | weaving=camel-seda-2.22 | <Link to="../release-notes/java/java-2_2_20" target="_blank">v2.2.20</Link>            |
| 3.2 이상           | weaving=camel-seda-3.2  | <Link to="../release-notes/java/java-2_2_20" target="_blank">v2.2.20</Link>            |

### DB2

| DB2 Version | 설정 값          | 에이전트 최소 버전 |
| ----------- | ---------------- | :----------------: |
| 11.5 이상   | weaving=db2-11.5 | <Link to="../release-notes/java/java-2_2_18" target="_blank">v2.2.18</Link>            |

### DynamoDB

| DynamoDB Version | 설정 값               | 에이전트 최소 버전 |
| ---------------- | --------------------- | :----------------: |
| 1.11             | weaving=dynamodb-1.11 | <Link to="../release-notes/java/java-2_2_39" target="_blank">v2.2.39</Link>            |
| 2.25             | weaving=dynamodb-2.25 | <Link to="../release-notes/java/java-2_2_39" target="_blank">v2.2.39</Link>            |

### Feign Client

| Feign Version | 설정 값          | 에이전트 최소 버전 |
| ------------- | ---------------- | :----------------: |
| 11 이상       | weaving=feign-11 | <Link to="../release-notes/java/java-2_2_6" target="_blank">v2.2.6</Link>             |

### Hystrix

| Hystrix Version | 설정 값             | 에이전트 최소 버전 |
| --------------- | ------------------- | :----------------: |
| 1.5 이상        | weaving=hystrix-1.5 | <Link to="../release-notes/java/java-2_0_21" target="_blank">v2.0_21</Link>            |

### Kafka

| Kafka Version            | 설정 값                     | 에이전트 최소 버전 |
| ------------------------ | --------------------------- | :----------------: |
| kafka-clients 2.4.0 이상 | weaving=kafka-clients-2.4.0 | <Link to="../release-notes/java/java-2_2_15" target="_blank">v2.2.15</Link>            |
| reactor-kafka 1.3 이상   | weaving=reactor-kafka-1.3   | <Link to="../release-notes/java/java-2_2_5" target="_blank">v2.2.5</Link>             |

### Logging

#### Log4j2

| Log4j2 Version | 설정 값            | 에이전트 최소 버전 |
| -------------- | ------------------ | :----------------: |
| 2.17 이상      | weaving=log4j-2.17 | <Link to="../release-notes/java/java-2_2_28" target="_blank">v2.2.28</Link>            |

:::note

[특정 appender 제외하는 에이전트 옵션 제공](agent-log#excludeappender)

:::

#### Logback

| Logback Version | 설정 값               | 에이전트 최소 버전 |
| --------------- | --------------------- | :----------------: |
| 1.2.8 이상      | weaving=logback-1.2.8 | <Link to="../release-notes/java/java-2_2_28" target="_blank">v2.2.28</Link>            |

:::note

[특정 appender 제외하는 에이전트 옵션 제공](agent-log#excludeappender)

:::

### MongoDB

| MongoDB Version | 설정 값             | 에이전트 최소 버전 |
| --------------- | ------------------- | :----------------: |
| 3.8.2 이상      | weaving=mongodb-3.8 | <Link to="../release-notes/java/java-2_2_11" target="_blank">v2.2.11</Link>            |
| 4.0.3 이상      | weaving=mongodb-4.0 | <Link to="../release-notes/java/java-2_2_11" target="_blank">v2.2.11</Link>            |
| 4.4 이상        | weaving=mongodb-4.4 | <Link to="../release-notes/java/java-2_2_11" target="_blank">v2.2.11</Link>            |
| 4.8 이상        | weaving=mongodb-4.8 | <Link to="../release-notes/java/java-2_2_11" target="_blank">v2.2.11</Link>            |
| 4.11 이상       | weaving=mongodb-4.11| <Link to="../release-notes/java/java-2_2_45" target="_blank">v2.2.45</Link>            |
| 5.0 이상        | weaving=mongodb-5.0 | <Link to="../release-notes/java/java-2_2_45" target="_blank">v2.2.45</Link>            |

### Mule Framework

| Mule Version | 설정 값            | 에이전트 최소 버전 |
| ------------ | ------------------ | :----------------: |
| 3.9.5 이상   | weaving=mule-3.9.5 | <Link to="../release-notes/java/java-2_2_23" target="_blank">v2.2.23</Link>            |
| 4.5 이상     | weaving=mule-4.5   | <Link to="../release-notes/java/java-2_2_23" target="_blank">v2.2.23</Link>            |

### OkHttp

| OkHttp Version | 설정 값             |                             에이전트 최소 버전                              |
| -------------- | ------------------- | :-------------------------------------------------------------------------: |
| 2.7 이상       | weaving=okhttp-2.7  | <Link to="../release-notes/java/java-2_0_15" target="_blank">v2.0_15</Link> |
| 3.x            | weaving=okhttp3     | <Link to="../release-notes/java/java-2_0_15" target="_blank">v2.0_15</Link> |
| 3.x (4.4 이상) | weaving=okhttp3-4.4 |  <Link to="../release-notes/java/java-2_2_9" target="_blank">v2.2.9</Link>  |

### Quarkus Reactive

| Quarkus Reactive Version | 설정 값                       | 에이전트 최소 버전 |
| ------------------------ | ----------------------------- | :----------------: |
| 1.13 이상                | weaving=quarkus-reactive-1.13 | <Link to="../release-notes/java/java-2_2_19" target="_blank">v2.2.19</Link>            |
| 2.10 이상                | weaving=quarkus-reactive-2.10 | <Link to="../release-notes/java/java-2_2_19" target="_blank">v2.2.19</Link>            |

### RabbitMQ

| reactor-rabbitmq Version | 설정 값                      | 에이전트 최소 버전 |
| ------------------------ | ---------------------------- | :----------------: |
| 1.2 이상                 | weaving=reactor-rabbitmq-1.2 | <Link to="../release-notes/java/java-2_0_06" target="_blank">v2.0_06</Link>            |

### Redis

#### Jedis

| Jedis Version | 설정 값           | 에이전트 최소 버전 |
| ------------- | ----------------- | :----------------: |
| 2.9.0 이상    | weaving=jedis-2.9 | <Link to="../release-notes/java/java-2_2_43" target="_blank">v2.2.43</Link>            |
| 2.9.3 이상    | weaving=jedis-2.9 | <Link to="../release-notes/java/java-2_0_33" target="_blank">v2.0_33</Link>            |
| 3.2 이상      | weaving=jedis-3.2 | <Link to="../release-notes/java/java-2_0_09" target="_blank">v2.0_09</Link>            |

#### Lettuce

| Lettuce Version | 설정 값             | 에이전트 최소 버전 |
| --------------- | ------------------- | :----------------: |
| 5.1 이상        | weaving=lettuce-5.1 | <Link to="../release-notes/java/java-2_2_7" target="_blank">v2.2.7</Link>             |
| 6.2 이상        | weaving=lettuce-6.2 | <Link to="../release-notes/java/java-2_2_16" target="_blank">v2.2.16</Link>            |

### Retrofit

| Retrofit Version | 설정 값              | 에이전트 최소 버전 |
| ---------------- | -------------------- | :----------------: |
| 2.5 이상         | weaving=retrofit-2.5 | <Link to="../release-notes/java/java-2_2_39" target="_blank">v2.2.39</Link>            |

:::caution

okhttp 설정과 동시 사용 불가

:::

### Ribbon

| Ribbon Version | 설정 값         | 에이전트 최소 버전 |
| -------------- | --------------- | :----------------: |
| 전체 버전      | weaving=ribbon  | <Link to="../release-notes/java/java-2_2_10" target="_blank">v2.2.10</Link>            |

### Spring Boot

| Spring Boot Version | 설정 값                 | 에이전트 최소 버전 |
| ------------------- | ----------------------- | :----------------: |
| 2.1 이상            | weaving=spring-boot-2.1 | <Link to="../release-notes/java/java-2_2_23" target="_blank">v2.2.23</Link>            |
| 2.5 이상            | weaving=spring-boot-2.5 | <Link to="../release-notes/java/java-2_2_9" target="_blank">v2.2.9</Link>             |
| 2.7 이상            | weaving=spring-boot-2.7 | <Link to="../release-notes/java/java-2_2_9" target="_blank">v2.2.9</Link>             |
| 3.0 이상            | weaving=spring-boot-3.0 | <Link to="../release-notes/java/java-2_2_9" target="_blank">v2.2.9</Link>             |
| 3.2 이상            | weaving=spring-boot-3.2 | <Link to="../release-notes/java/java-2_2_38" target="_blank">v2.2.38</Link>            |

<details>
<summary>포함 기술 스택 보기</summary>

- **spring-boot-2.1**: r2dbc-mysql-0.8.2, spring-cloud-gateway-2.1, spring-kafka-2.7, spring-webflux-5.1, tomcat9
- **spring-boot-2.5**: r2dbc-mysql-0.8.2, spring-cloud-gateway-3.0, spring-kafka-2.7, spring-webflux-5.3, mongodb-4.0.3, reactor-kafka-1.3, rxjava2, tomcat9
- **spring-boot-2.7**: jasync-r2dbc-mysql-2.1.23, r2dbc-mysql-0.9.3, spring-cloud-gateway-3.1, spring-kafka-3.0, spring-webflux-5.3, mongodb-4.4, reactor-kafka-1.3, rxjava2, tomcat9
- **spring-boot-3.0**: jasync-r2dbc-mysql-2.1.23, r2dbc-mysql-1.0.2, spring-cloud-gateway-4.0, spring-kafka-3.0, spring-webflux-6.0, mongodb-4.8, redis(lettuce-6.2), reactor-kafka-1.3, rxjava3, tomcat10
- **spring-boot-3.2**: jasync-r2dbc-mysql-2.1.23, r2dbc-mysql-1.1.3, spring-cloud-gateway-4.1, spring-kafka-3.1, spring-webflux-6.1, redis(lettuce-6.2), reactor-kafka-1.3, rxjava3, tomcat10

</details>

### Tomcat

| Tomcat Version | 설정 값          | 에이전트 최소 버전 |
| -------------- | ---------------- | :----------------: |
| 9.x            | weaving=tomcat9  | <Link to="../release-notes/java/java-2_2_5" target="_blank">v2.2.5</Link>             |
| 10.x           | weaving=tomcat10 | <Link to="../release-notes/java/java-2_2_5" target="_blank">v2.2.5</Link>             |

### Undertow

| Undertow Version | 설정 값              | 에이전트 최소 버전 |
| ---------------- | -------------------- | :----------------: |
| 2.2 이상         | weaving=undertow-2.2 | <Link to="../release-notes/java/java-2_2_39" target="_blank">v2.2.39</Link>            |
| 2.3 이상         | weaving=undertow-2.3 | <Link to="../release-notes/java/java-2_2_14" target="_blank">v2.2.14</Link>            |

### Vert.x

| Vert.x Version | 설정 값           | 에이전트 최소 버전 |
| -------------- | ----------------- | :----------------: |
| 3.5.3          | weaving=vertx-3.5 | <Link to="../release-notes/java/java-2_2_42" target="_blank">v2.2.42</Link>            |
| 3.9            | weaving=vertx-3.9 | <Link to="../release-notes/java/java-2_2_44" target="_blank">v2.2.44</Link>            |
| 4.5            | weaving=vertx-4.5 | <Link to="../release-notes/java/java-2_2_39" target="_blank">v2.2.39</Link>            |

## Java 에이전트의 CVE 오탐 방지

Java 에이전트에 포함된 라이브러리 클래스는 애플리케이션에서 실제 사용할 때만 로딩됩니다. CVE 취약점 검사 시 라이브러리가 검출되더라도, 사용하지 않는다면 실제 취약점은 없습니다.

불필요한 추적 클래스를 삭제하려면 다음 명령어를 실행하세요.
```bash
java -cp whatap.agent-X.Y.Z.jar whatap.agent.setup.RemoveWeaving -remove [weaving jar filename]
```

:::caution
Java 에이전트 업데이트 시마다 삭제 작업을 다시 수행해야 합니다.
:::

:::note

특정 라이브러리 클래스를 제거하는 명령어는 **Java 에이전트 2.2.37 버전** 이상에서 지원합니다.

**사용법**: `java -cp whatap.agent-X.Y.Z.jar whatap.agent.setup.RemoveWeaving [arguments] [weaving jar filename]`
```bash title="Example"
java -cp whatap.agent-2.2.37.jar whatap.agent.setup.RemoveWeaving -remove spring-boot-2.5.jar spring-boot-2.7.jar
```

**Arguments:**

* `-r` 또는 `-remove`: Java 에이전트에서 weaving jar 파일을 삭제하고 새로운 Java 에이전트를 생성합니다.

* `-l` 또는 `-list`: weaving jar 파일 목록을 출력합니다.

* `-d` 또는 `-debug`: 디버그 로깅(debug logging)을 활성화합니다.

* `-e` 또는 `-error`: 에러에 대한 풀 스택 트레이스 정보를 표시합니다.

* `-h` 또는 `-help`: 도움말 출력하고 종료합니다.

:::