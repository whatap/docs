---
id: agent-weaving
title: 오픈소스 추적
description: 자바(Java) 애플리케이션에서 사용하는 프레임워크나 오픈소스 라이브러리를 에이전트를 통해 추적하는 설정 방법을 제공합니다. Java 에이전트 설정 파일(whatap.conf)에 weaving 옵션을 추가하여 설정하며, 다양한 프레임워크 및 라이브러리 버전에 대응하는 방법을 안내합니다.
keywords: [ Java, 에이전트, 오픈소스 추적, Weaving ]
---

자바(Java) 애플리케이션에서 사용하는 프레임워크나 오픈소스 라이브러리를 에이전트를 통해 추적하는 설정 방법을 제공합니다. 이는 Java 에이전트 설정 파일(*whatap.conf*) 파일에 `weaving` 옵션을 추가하여 설정하며, 다양한 프레임워크 및 라이브러리 버전에 대응하는 방법을 안내합니다.

예를 들어, 프레임워크나 오픈소스로 spring-boot-3.x, feign-client-11, okhttp3-4.4 사용 시 다음과 같이 옵션을 설정하세요.
```ini title='whatap.conf'
weaving=spring-boot-3.0,feign-11,okhttp3-4.4
```

## 지원 오픈소스 목록

Java 에이전트를 통해 추적하고 있는 프레임워크 또는 오픈소스에 대한 설정 방법은 다음을 참조하세요.

### Apache Camel

#### CXF
| 에이전트 버전 | camel-cxf-3.15 이상 |
| --- | :---: |
| v2.2.27 | O |

#### Netty
| 에이전트 버전 | camel-netty4-2.25 이상 |
| --- | :---: |
| v2.2.42 | O |

#### SEDA
| 에이전트 버전 | camel-seda-2.22 이상 | camel-seda-3.2 이상 |
| --- | :---: | :---: |
| v2.2.20 | O | O |

### DB2
| 에이전트 버전 | db2-11.5 이상 |
| --- | :---: |
| v2.2.18 | O |

### DynamoDB
| 에이전트 버전 | dynamodb-1.11 | dynamodb-2.25 |
| --- | :---: | :---: |
| v2.2.39 | O | O |

### Feign Client
| 에이전트 버전 | feign-11 이상 |
| --- | :---: |
| v2.2.6 | O |

### Hystrix
| 에이전트 버전 | hystrix-1.5 이상 |
| --- | :---: |
| v2.0_21 | O |

### Kafka
| 에이전트 버전 | kafka-clients-2.4.0 이상 | reactor-kafka-1.3 이상 |
| --- | :---: | :---: |
| v2.2.15 | O | X |
| v2.2.5 | X | O |

### 로깅

#### Log4j2
| 에이전트 버전 | log4j-2.17 이상 |
| --- | :---: |
| **비고** | [특정 appender 제외하는 에이전트 옵션 제공](agent-log#excludeappender) |
| v2.2.28 | O |

#### Logback
| 에이전트 버전 | logback-1.2.8 이상 |
| --- | :---: |
| **비고** | [특정 appender 제외하는 에이전트 옵션 제공](agent-log#excludeappender) |
| v2.2.28 | O |

### MongoDB
| 에이전트 버전 | 3.8.2 이상 | 4.0.3 이상 | 4.4 이상 | 4.8 이상 | 4.11 이상 | 5.0 이상 |
| --- | :---: | :---: | :---: | :---: | :---: | :---: |
| v2.2.45 | O | O | O | O | O | O |
| v2.2.11 | O | O | O | O | X | X |

### Mule Framework
| 에이전트 버전 | mule-3.9.5 이상 | mule-4.5 이상 |
| --- | :---: | :---: |
| v2.2.23 | O | O |

### OkHttp
| 에이전트 버전 | okhttp-2.7 이상 | okhttp3 | okhttp3-4.4 |
| --- | :---: | :---: | :---: |
| v2.2.9 | O | O | O |
| v2.0_15 | O | O | X |

### Quarkus Reactive
| 에이전트 버전 | quarkus-reactive-1.13 이상 | quarkus-reactive-2.10 이상 |
| --- | :---: | :---: |
| v2.2.19 | O | O |

### RabbitMQ
| 에이전트 버전 | reactor-rabbitmq-1.2 이상 |
| --- | :---: |
| v2.0_06 | O |

### Redis

#### Jedis
| 에이전트 버전 | jedis-2.9.0 이상 | jedis-2.9.3 이상 | jedis-3.2 이상 |
| --- | :---: | :---: | :---: |
| v2.2.43 | O | O | O |
| v2.0_33 | X | O | O |
| v2.0_09 | X | X | O |

#### Lettuce
| 에이전트 버전 | lettuce-5.1 이상 | lettuce-6.2 이상 |
| --- | :---: | :---: |
| v2.2.16 | O | O |
| v2.2.7 | O | X |

### Retrofit
| 에이전트 버전 | retrofit-2.5 이상 |
| --- | :---: |
| **비고** | okhttp 설정과 동시 사용 불가 |
| v2.2.39 | O |

### Ribbon
| 에이전트 버전 | ribbon |
| --- | :---: |
| v2.2.10 | O |

### Spring Boot
| 에이전트 버전 | 2.1 이상 | 2.5 이상 | 2.7 이상 | 3.0 이상 | 3.2 이상 |
| --- | :---: | :---: | :---: | :---: | :---: |
| v2.2.38 | O | O | O | O | O |
| v2.2.23 | O | X | X | X | X |
| v2.2.9 | X | O | O | O | X |

<details>
<summary>포함 기술 스택 보기</summary>

- **spring-boot-2.1**: r2dbc-mysql-0.8.2, spring-cloud-gateway-2.1, spring-kafka-2.7, spring-webflux-5.1, tomcat9
- **spring-boot-2.5**: r2dbc-mysql-0.8.2, spring-cloud-gateway-3.0, spring-kafka-2.7, spring-webflux-5.3, mongodb-4.0.3, reactor-kafka-1.3, rxjava2, tomcat9
- **spring-boot-2.7**: jasync-r2dbc-mysql-2.1.23, r2dbc-mysql-0.9.3, spring-cloud-gateway-3.1, spring-kafka-3.0, spring-webflux-5.3, mongodb-4.4, reactor-kafka-1.3, rxjava2, tomcat9
- **spring-boot-3.0**: jasync-r2dbc-mysql-2.1.23, r2dbc-mysql-1.0.2, spring-cloud-gateway-4.0, spring-kafka-3.0, spring-webflux-6.0, mongodb-4.8, redis(lettuce-6.2), reactor-kafka-1.3, rxjava3, tomcat10
- **spring-boot-3.2**: jasync-r2dbc-mysql-2.1.23, r2dbc-mysql-1.1.3, spring-cloud-gateway-4.1, spring-kafka-3.1, spring-webflux-6.1, redis(lettuce-6.2), reactor-kafka-1.3, rxjava3, tomcat10

</details>

### Tomcat
| 에이전트 버전 | tomcat9 | tomcat10 |
| --- | :---: | :---: |
| v2.2.5 | O | O |

### Undertow
| 에이전트 버전 | undertow-2.2 이상 | undertow-2.3 이상 |
| --- | :---: | :---: |
| v2.2.39 | O | O |
| v2.2.14 | X | O |

### Vert.x
| 에이전트 버전 | vertx-3.5.3 | vertx-3.9 | vertx-4.5 |
| --- | :---: | :---: | :---: |
| v2.2.44 | O | O | O |
| v2.2.42 | O | X | X |
| v2.2.39 | X | X | O |

## Java 에이전트의 CVE 오탐 방지

Java 에이전트의 CVE 취약점 오탐 방지 및 불필요한 라이브러리 클래스 제거 방법을 안내합니다.

CVE 취약점이 검출되더라도, Java 에이전트가 실제로 취약하지 않을 수 있습니다. Java 애플리케이션에서 사용하는 라이브러리 정보를 모니터링하기 위해 에이전트에는 다양한 라이브러리 클래스가 포함되어 있지만, 실제로 사용하지 않는다면 로딩되지 않습니다. Java 애플리케이션에서 특정 클래스가 로딩될 때에만 추적 클래스와 메소드가 결합되어 모니터링이 이루어지기 때문입니다.

따라서, CVE 취약점 검사 시 소프트웨어의 이름과 버전만을 기반으로 경고가 발생할 수 있습니다. 여러 라이브러리가 검출되더라도, 실제 애플리케이션에서 해당 라이브러리를 사용하지 않으면 취약점이 노출되지 않으므로 반드시 취약한 상태인 것은 아닙니다.

만약 Java 애플리케이션에서 해당 버전을 사용하지 않고 추적 클래스를 삭제하려면 아래 명령어를 실행하세요. 단, Java 에이전트가 업데이트될 때마다 삭제 작업을 다시 수행해야 합니다.
```bash
java -cp whatap.agent-X.Y.Z.jar whatap.agent.setup.RemoveWeaving -remove [weaving jar filename]
```

:::note

특정 라이브러리 클래스를 제거하는 명령어는 **Java 에이전트 2.2.37 버전** 이상에서 지원합니다.

**사용법**: `java -cp whatap.agent-X.Y.Z.jar whatap.agent.setup.RemoveWeaving [arguments] [weaving jar filename]`
```bash title="Example"
java -cp whatap.agent-2.2.37.jar whatap.agent.setup.RemoveWeaving -remove spring-boot-2.5.jar spring-boot-2.7.jar
```

Arguments:

* `-r` 또는 `-remove`: Java 에이전트에서 weaving jar 파일을 삭제하고 새로운 Java 에이전트를 생성합니다.

* `-l` 또는 `-list`: weaving jar 파일 목록을 출력합니다.

* `-d` 또는 `-debug`: 디버그 로깅(debug logging)을 활성화합니다.

* `-e` 또는 `-error`: 에러에 대한 풀 스택 트레이스 정보를 표시합니다.

* `-h` 또는 `-help`: 도움말 출력하고 종료합니다.

:::