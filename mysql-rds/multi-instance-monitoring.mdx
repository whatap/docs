---
id: multi-instance-monitoring
title: 멀티 인스턴스 모니터링
description: 여러 인스턴스들의 지표를 한 화면에서 확인하고 비교할 수 있습니다.
tags: [ MySQL RDS, 인스턴스, 대시보드, 데이터베이스 모니터링, 멀티 인스턴스 모니터링 ]
---

import ProdImg from '@site/src/components/ChangeImgName.js';

홈 화면 > 프로젝트 선택 > ***대시보드*** > ***멀티 인스턴스 모니터링***

***[인스턴스 모니터링](instance-monitoring)*** 메뉴에서는 하나의 인스턴스만 모니터링한다면, ***멀티 인스턴스 모니터링***은 여러 인스턴스들의 지표를 한 화면에서 확인하고 비교할 수 있습니다. 동작 중인 에이전트 수, 액티브 세션의 총합, 평균 버퍼 히트율 등의 인스턴스 지표를 그룹핑한 값을 통해 인스턴스들의 현황을 파악할 수 있습니다. 그래프 차트를 통해 인스턴스의 지표 값 추이와 어떤 인스턴스의 지표 값이 높은지 쉽게 확인할 수 있습니다. 가장 오래 지속하는 액티브 세션 정보를 제공합니다.

{@include: ../common-items/_db-multi-instance-monitoring-desc-notes.mdx}

## 기본 화면 안내

<ProdImg img='db-multi-instance.png' desc='멀티 인스턴스 모니터링' />

### ![](/img/number-01.png) 인스턴스

에이전트를 설치를 통해 연결한 인스턴스 목록입니다. 인스턴스의 색상은 화면 가운데 영역에서 그래프 차트의 색상과 일치합니다. 인스턴스를 선택했을 때 색상이 회색으로 변하면 선택 해제된 상태입니다. 각 지표와 그래프 차트에서 해제한 인스턴스의 데이터를 제외합니다.

### ![](/img/number-02.png) 인스턴스 상태 파악{#instance-status}

* ***Instance***

  활성화/비활성화된 인스턴스 개수를 확인할 수 있습니다.

* ***Active Session***

  `Threads_running` 변수와 같습니다. sleeping 되어 있지 않은 활성화된 Thread 수입니다.

* ***Connection Usage***

  현재 열려있는 연결 비율(Connection thread)입니다. 이 비율이 높으면 MySQL 서버에 대한 동시 연결이 많음을 의미하며, 'Too many connections' 오류가 발생할 수 있습니다. 연결 비유을 얻는 공식은 다음과 같습니다.

  ```txt
  
  Current connections(%) = (threads_connected / max_connections) x 100
  
  ```
  
  :::note
  
  최적의 비율 값은 80%이거나 그 이하여야 합니다. `max_connections` 변수를 늘리거나 SHOW FULL PROCESSLIST를 이용해 연결을 검사해 보세요. 'Too many connections' 오류가 발생하면 일부 연결을 해제할 때까지 슈퍼 유저가 아닌 일반 사용자는 MySQL 데이터베이스 서버에 접근할 수 없습니다. `max_connections` 변수 값을 늘리면 MySQL의 메모리 사용량이 증가할 수도 있습니다.

  :::

* ***Buffer Hit Rate***

  페이지가 디스크가 아닌 메모리에서 검색되는 빈도의 비율입니다. MySQL을 처음 시작할 때 ***Buffer Hit Rate*** 값이 낮으면 버퍼 풀(buffer pool)을 워밍업할 때까지 약간의 시간을 허용하세요. 100%가 최적의 값이며, 이는 자주 액세스하는 데이터가 메모리에 완전히 들어있다는 의미입니다.

  :::note

  `innodb_buffer_pool_size` 변수를 늘리면 MySQL이 작업할 공간을 더 많이 확보하는 데 도움이 됩니다. 그러나 사전에 충분한 메모리 리소스가 있는지 확인하세요. 중복 인덱스를 제거하는 것도 도움이 될 수 있습니다.

  :::

* ***SQL Executed***

  선택한 인스턴스들의 초당 SQL 수행건수 합계입니다. 5초단위로 수집한 `Questions`(전체 쿼리 요청 횟수) 지표 값을 기반으로 합니다.

* ***Lock waiting***

  `Innodb_row_lock_current_waits` 변수의 값을 사용합니다. 현재 row lock을 획득하기 위해 대기 중인 수입니다.


### ![](/img/number-03.png) 인스턴스 지표 현황

전체 인스턴스의 중요 지표를 다음 네 가지 분류를 통해 파악할 수 있습니다. 각 그래프의 색상은 ![숫자 1](/img/number-01.png)에서 인스턴스의 색상과 일치합니다. 시간에 따른 지표 값의 추이를 그래프 차트를 통해 확인할 수 있습니다.

* ***Connection***

  Sleeping 되어 있지 않은 활성화된 Thread 수(***Threads_running***)와 현재 연결된 Thread 수(***Threads_connected***)를 실시간으로 조회합니다. 이는 ![숫자 2](/img/number-02.png)에 ***[Connection Usage](#instance-status)***와 관련이 있습니다. DB 서버에 대한 접속이 많아지는 경우 관련한 튜닝을 찾아보고 조치를 취하세요.

* ***Throughput***

  처리하는 데이터의 양의 관점에서 인스턴스의 성능을 모니터링할 수 있습니다. 어떤 인스턴스가 많은 양의 업무를 처리하는지 확인하세요. 지표에 대한 자세한 내용은 [다음 문서](metrics-data-list)를 참조하세요.

* ***Performance***

  서버 상태에 대한 관련 지표를 모니터링합니다. 해당 섹션에 포함된 지표들의 값이 커지면 성능을 저하시키는 요인이 됩니다. 지표에 대한 자세한 내용은 [다음 문서](metrics-data-list)를 참조하세요.

* ***Disk I/O***

  디스크 사용률을 통해 데이터베이스 처리 성능에 미치는 영향을 모니터링할 수 있습니다. 해당 섹션에 포함된 지표들의 값이 높아지면 과도하게 디스크를 사용하고 있다는 것입니다. 지표에 대한 자세한 내용은 [다음 문서](metrics-data-list)를 참조하세요.


### ![](/img/number-04.png) 액티브 세션 / 락 트리

실시간 수행 중인 액티브 세션 및 락 트리 정보를 조회할 수 있습니다.

* ***Acitive Sessions*** 

  실시간 수행 중인 세션과 쿼리 내용을 조회할 수 있습니다. 테이블에서 가장 오른쪽에 ***query*** 컬럼의 항목을 선택하면 ***SQL 보기*** 창이 나타납니다. 선택한 쿼리(Query)에 대한 Full Text 및 Plan 정보를 확인할 수 있습니다. 테이블의 컬럼에 대한 자세한 내용은 [다음 문서](#column-info)를 참조하세요.

* ***락 트리***

  실시간으로 락 세션에 대한 정보와 Holder, Waiter 정보를 조회할 수 있습니다. 테이블의 컬럼에 대한 자세한 내용은 [다음 문서](#column-info)를 참조하세요.

{@include: ../common-items/_db-data-list-filter.mdx}

## 테이블 컬럼 변경하기{#change-column}

{@include: ../common-items/_db-data-edit-column.mdx}

{@include: ../common-items/_db_ats-lock-column.mdx}