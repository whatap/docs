---
id: golang-0.1.14
title: Golang Agent 0.1.14 ğŸš€
toc_max_heading_level: 2
---

import Status from '@site/src/components/Highlight';
import UI from '@site/src/components/UItext';

ë°°í¬ì¼: 2022-12-14

* <Status>Fixed</Status> UDP ì„œë²„ê°€ ì¤‘ì§€ëœ ìƒíƒœì—ì„œ CPU ì‚¬ìš©ëŸ‰ì´ ì¦ê°€í•˜ëŠ” í˜„ìƒ ìˆ˜ì •

  UDP ì„œë²„ê°€ ì¤‘ì§€ëœ ìƒíƒœ(whatap-agent ì„œë¹„ìŠ¤ê°€ ì¤‘ì§€)ì—ì„œ Golang ëª¨ë‹ˆí„°ë§ì„ ì ìš©í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ CPU ë¶€í•˜ê°€ ì¦ê°€í•©ë‹ˆë‹¤. UDP ì„œë²„ ì ‘ì† ë° ì¢…ë£Œ ì²˜ë¦¬ê°€ ë°˜ë³µë˜ë©´ì„œ UDP ì—°ê²°ì´ ì—¬ëŸ¬ ê°œ ìœ ì§€ë˜ì–´ CPU ì‚¬ìš©ëŸ‰ì´ ì¦ê°€í•˜ì˜€ìŠµë‹ˆë‹¤.

* <Status>New</Status> k8s.io/client-go/kubernetes ë¼ì´ë¸ŒëŸ¬ë¦¬ ì§€ì›

  [ì°¸ì¡° ì˜ˆì œ](https://github.com/whatap/go-api-example/tree/main/github.com/go-chi/chi)

  ```go title='golang'
  import (
    "k8s.io/client-go/rest"
  )

  func main() {
    // Init whatap trace
    config := make(map[string]string)
    trace.Init(config)
    defer trace.Shutdown()

    ...

    config, err := clientcmd.BuildConfigFromFlags("", *kubeconfig)
    if err != nil {
      return nil, err
    }

    // whatap roundTripper í•¨ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. 
    config.WrapTransport = wRT.WrapRoundTripper()

    clientset, err := kubernetes.NewForConfig(config)
    if err != nil {
      return nil, err
    }

    deploymentsClient := clientset.AppsV1().Deployments(conf.Server.Namespace)

    ...
  }
  ```

* <Status>New</Status> github.com/gofiber/fiber/v2 ë¼ì´ë¸ŒëŸ¬ë¦¬ ì§€ì›

  [ì°¸ì¡° ì˜ˆì œ](https://github.com/whatap/go-api-example/tree/main/github.com/gofiber/fiber/v2/whatapfiber)

  ```go title='golang'
  import (
    "github.com/whatap/go-api/instrumentation/github.com/gofiber/fiber/v2/whatapfiber"
  )

  func main() {
    // Init whatap trace
    config := make(map[string]string)
    trace.Init(config)
    defer trace.Shutdown()

    ...

    r := fiber.New(fiber.Config{
      StrictRouting: true,
      Views:         engine,
    })

    r.Use(recover.New())

    // whatapfiberì˜ middlewareë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.
    r.Use(whatapfiber.Middleware())
    
    ...
  }
  ```

* <Status>New</Status> github.com/valyala/fasthttp ë¼ì´ë¸ŒëŸ¬ë¦¬ ì§€ì›

  [ì°¸ì¡° ì˜ˆì œ](https://github.com/whatap/go-api-example/tree/main/github.com/valyala/fasthttp/whatapfasthttp)

  ```go title='golang'
  import (
    "github.com/whatap/go-api/instrumentation/github.com/valyala/fasthttp/whatapfasthttp"
  )

  func main() {
    // Init whatap trace
    config := make(map[string]string)
    trace.Init(config)
    defer trace.Shutdown()

    ...
      
    r := fiber.New(fiber.Config{
      StrictRouting: true,
      Views:         engine,
    })

    r.Use(recover.New())

    // ë˜í¼ (Wrapper) í•¨ìˆ˜ whatapfasthttp.Funcì„ ì‚¬ìš©í•©ë‹ˆë‹¤. 
    r.GET("/", whatapfasthttp.Func(func(ctx *fasthttp.RequestCtx) {
      ...
    }))
    r.GET("/hello/{name}", whatapfasthttp.Func(func(ctx *fasthttp.RequestCtx) {
      fmt.Fprintf(ctx, "Hello, %s!\n", ctx.UserValue("name"))
      ctx.SetContentType("text/html;charset=utf8")
    }))
  }
  ````
  